# -*- coding: utf-8 -*-
"""adult_data_analysis.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1fIXQ3eA0tp0sq0iLCY-W2ibBqqH_x71V
"""

import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

# Reading data from the file

df = pd.read_csv('/adult.data.csv')

#basic info

print(df.describe())
print(df.info())
print(df.shape)

# How many of each race are represented in this dataset? This should be a Pandas series with race names as the index labels

race_count = (df['race']).value_counts()
print (race_count)

# What is the average age of men?

average_age_men = df[df['sex'] == 'Male']['age'].mean()
print (average_age_men)

# What is the percentage of people who have a Bachelor's degree?

percentage_bachelors = len(df[df['education']=='Bachelors']) * 100 / len(df['education'])
print(percentage_bachelors)

# What percentage of people with advanced education (`Bachelors`, `Masters`, or `Doctorate`) make more than 50K?

print((len(df[(df['education'].isin(['Bachelors', 'Masters', 'Doctorate'])) & (df['salary'] == '>50K')]) * 100) / (len(df[(df['education'].isin(['Bachelors', 'Masters', 'Doctorate']))])))

# What percentage of people without advanced education make more than 50K?

people_without_advanced_50k = len(df[(~df['education'].isin(['Bachelors', 'Masters', 'Doctorate'])) & (df['salary'] == '>50K')])
people_without_advanced = (len(df[(~df['education'].isin(['Bachelors', 'Masters', 'Doctorate']))]))
percentage = (people_without_advanced_50k / people_without_advanced) * 100
print (percentage)

# Minimum and maximum work hours per week

print(f"Minimum hours per week: {df['hours-per-week'].min()}")
print(f"Maximum hours per week: {df['hours-per-week'].max()}")

#plot

plot = df['hours-per-week'].hist(color = 'black')
plt.xlabel('Hours Worked Per Week')
plt.ylabel('Number of People')
plt.title('Distribution of Work Hours Per Week')
plt.tight_layout()
plt.show()

# What percentage of the people who work the minimum number of hours per week have a salary of >50K?

print(len(df[(df['hours-per-week'] == df['hours-per-week'].min()) & (df['salary'] == '>50K')]) * 100 / len(df[(df['hours-per-week'] == df['hours-per-week'].min())]))

# What country has the highest percentage of people that earn >50K?

country_percentages = (df[df['salary'] == '>50K']['native-country'].value_counts() / df['native-country'].value_counts()) * 100

highest_earning_country_percentage = round(country_percentages.max(), 1)
highest_earning_country = country_percentages.idxmax()
print (highest_earning_country)

#plot

country_percentages.plot(kind='bar', color = 'black')
plt.xlabel('Country')
plt.ylabel('Percentage of people')
plt.title('Percentage of people that earn >50K (country-wise)')
plt.tight_layout()
plt.show()

# Identify the most popular occupation for those who earn >50K in India

rich_indians = df[(df['native-country'] == 'India') & (df['salary'] == '>50K')]
top_occupation = rich_indians['occupation'].value_counts().idxmax()
print(top_occupation)